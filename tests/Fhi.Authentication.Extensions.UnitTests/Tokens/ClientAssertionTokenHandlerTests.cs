using Fhi.Authentication.Tokens;
using System.IdentityModel.Tokens.Jwt;

namespace Fhi.Authentication.UnitTests.Tokens
{
    public class ClientAssertionTokenHandlerTests
    {
        /// <summary>
        /// Generate private and public key using JwkGenerator and create a client assertion token from private key using DefaultClientAssertionTokenHandler.
        /// </summary>
        [Test]
        public void GenerateKeysAndClientAssertion()
        {
            var keys = JwkGenerator.GenerateRsaJwk();

            string errorKey = """{"alg":"PS256","d":"rFBSjkAs0oQi6n_yoWPXLIoWvtmY6pioCcUnCFV_V2-T-QAhbn4SvW2GCz7RN6GkLr-XZitz5i-1v-G7p-Rkdrd3oj8vi8YDg6C_VGwyh9difsomPePDD2irl4s2uLfM3PioVjGxr8q3tZ5XMOU1KyN-ROfKh4wqY5xpkUSCzW48lPgJpW2Ja23tq4R2_eNyUy4b1qYTFL1TD_lPnOCDtLxwDyRUbCMote5hbyEAzBndxk8AyJ5TgZfPlWBAUJRu6p9dh7cdiwAg0vMoUwCuddy2zydS2u7TE5K5WjhYwyTSB1A3eiKk7dBEFioeZodZ46Mi660_wIs6awz3Bz4eyWasTAMizWYapUfNoGvqVeedVu5xuCiLAVW3jgJfZu5N37Y2N1q1-pmwW72H---BXFBhNRMtr0qbUcyJvvTLEaWwG9y2op-6yq5QJQoN6-Tzv8iGuijxd8xOK2kzUAItSgL2jtx5Bdy7VAbvzRBAzpC13j_B7z-Kt9Or5TGpylnNNgeoJliVA9ebZoByN6tVgx941VUFdtqvZgO-b1fpoNRUk1O5wMGC00-e-EVWKC6d2rCoMr4CDz-TpUSrL97uJQnm1gbyQuFiJgtAMZeBq522uLBZJcvo2qJT5wypwx3N92kOLVn-wMTjQnPmswAKK163vHWfhYb3x04M2Cr28Q","dp":"rnMBRE3Uhjf57wzUJhu1MCxD_YSkwMKt0gQUk9cpN7OAQRu6XFuyNGa1Z38jpFKHyj6oEAMA-i5xaalj53qDIJoAaAW_n5JOAP8oSMvAorjBBIyuowc9bKES7qeXMnsBRmH2f5K3RFUqS3U5dyABvpyiiMGraoYw-LZPZ3fbaEo3mRTpv5iWIa92EGytzQGrU7NxVTT4I0M25otgC2SJmq2--mYjo7jUxdmY-0RfosuKxcEOjRl2NpiK86kToT4rEAS1Unh_eYYIYBHihebGxw-0UEplQlgLFkPh86p4J0EEGoYRUgzSzARwk3O2-xI-Ophj0QaXAm44i3x78b0guQ","dq":"evXrg35EKpMFySoxpGudd0lRllJs1sOu63HLzZs9OErjkkeVKGKUu3pPQs09cQD5MBNiZoNM5v6LIzpyR3NJRyi0V_woBNziMAAfqzPE5kfgVWutYEp_VFdENL4qws_6JDBg6zGd5TjsmzD5euqPXJEXOlGqgaXJbVRnJYVLtuDyTgMHtVbYbkqhVzmlWPUMKTC7p5dNN90GtI4LCmGJWPQVMD8h2zzMX0zJ2XuU6dsjiugAQCKByDv-pwg_92BZ_teiLYpdo1T0EqsxRnM_b-a1T1ugA22fAWreqeCxK1HiDHC-6mQdugSwSH8o9mNi0evBx-3KqpTorOYI86wYqQ","e":"AQAB","key_ops":["sign"],"kty":"RSA","n":"newjn2E0TjpPhI3tfAhf1FuVCM2aXQvT-uRgDFwh6twvHT8GgXzL-W7UIutnre3Yuhg7ZmzsgweVoYj-9xpQ-a9Jo3ryXlvasD6PPFZTWxJAdhQkYcrZKCz3JD5yfwVdtPIehpW3y5iBEgbEQUkSY0vBv5oFl4cNYimriwKECRxyQ7OVpHlyazIdHNGwbbBdEHW0j6nFtZiBWI9PqM1nyih00JHE8mAmqGhBZ2q2AQMNU91Gpw-uPj7qeNbpuKqJnpmdKVChOsKZzkbbSXbXLu6_PZZsJroOD6OPNMxm7wlkqfmBB6eE8l32vmiqXq8fivypwJetmv-tLXfMI6CEnYsVmVEpDN4G2JuzdW-1lRhKco3boqGYPLH1geS6sJrve2DhlqCgrgv4NFwRPbJOlD2T-Bseu9J8NIOU7bnm65ibeVsfRUobQLqihTjq5EaWRuOeOWAMNwA6LRwF4vNUf--xGoqylzIhDxwj5-cHMD8DP18VHbBypayD0obNqoPli1BcTmbeT2jcTgJtzJ8YXdtZ5ywVO_uqtgjnr2Phxv1qS0ov4EoEDp1SAmCzLGvM_oahrnqXNgos3gVK9L-wwRWY8IO4d-AXIjoVq-gqeXiW69fhvPmSErSbymlu0wX1MjsJ8lRejfyTG7sgiTSlqBNXZwti44PvRb5azlzSKBM","p":"zuo7bkrk4LXEtbAVb_IKrJnNgccF1cL3MON2aeTfiO5wrlYGndVGlPNg3u5cvA9wLBA1SyeUuGWJx_Ou3kqIGWnVxgo_M8ec1C9gEEDVag8okIsoUPpEKYsJ7EZEAXSrur17OJhLpUjye71qqnz4JSG-cCkDcE5CxJJodTvYhriQyrr9C-GFmkzteeRvDhwwixAZsG6EHrScM2uCo8s0i6iboyznl4iwf5IiJBuXBww_f6k2mQYQ9SS2AnJJh5CjmOuvap3_17LWzXG8voVmmH9ooDCUw7qQo5nZbnvoeLoLteEytwmv7K985mFJ8t22Igm45aFHsrTMm5X9rNlmFQ","q":"w2KhsBC7WzALTD8Hz-qPeS1drFrjunw5ZYaJl54laaSoULXJOsQSjybF9ZmpPZaLfUjvTXk0uUlt387gAjgqRa3kJb3PGG-rd3YN7JsgBA0_3YOhO1zUOKYAnum58R7K3pKQ0XaouQ87F0xf6MlEyuViHbMc_qLjykJRcoJBLJhNKJO2Kgyl-zPQPiNIr_Ht9stexRoTA1DntA5ly_0-D21ONbRjLVolw4bMLG0Istw0-HMSZfXVHU7ST4qoR-dHrEpj_TKkywI0u2VliAKeXyD6mbCyKKdBalluMM68UcCSxZjvgkpijhR48Z8IDcgYXT6dLuWsez4qEdGCSEfHhw","qi":"ECaxyZRPjS8Ez3JnGJgiyMJqSpBfyGCV7Lit0_P13D5aEGSn7QXF40vnPDRGAVDxAyTKKF_keGypZXz7MrHresh1jUF9YSfYO_XhfcAC-13qpyCgd42_rHtDMUzVZJW26yJYEoJ5aKl9qR47K3bNJAX8bbhqeAnqTRbQcUB8YR0GzGZh0G-PtHuMxwP6oP5hJwmfSSGNfa6TYF2KEz7_HG9dcY8mbMa3GiiBwo3fHTvljmVPJ14kMvVGJLKne1v65KPihQW-9AXotdfxXYqxC1L27L6psT5S0_6vFB9R6pQi14peHjb5Pvxoe_QbE8nD6aazuJLhCmad8LhftFeXEg","kid":"yut23U6LHZe5VvR8hYHX-Rcqv1OdTlN_h0pACfn8Njk"}""";
            //string key2 = """{"alg":"PS256","d":"OJgBlJjeg48onJbavrlur9nGiHekZjBokrIKdO3QUI3PP9iBSh3cg7GTbNSwZMKk8rFPJo1AeJPAJzquwd8TVP7xsRvmOOyOU49Iwh93Gm89yj6a6IyHohSDcV9bQU0XbtLUV5ILuHCH3cBgasponiYX5-7vyZhAZ0o6f_jZc8usVZbRyPpFWTUz_P58ZMCsQpJibS7wj456oBJ08nwagDwuLob0Ad810bazVwEPfI_CGyz-Yg5mumybt0q8tHmz1hp1NqQoG9Cc0iSqAEsw1d_A8zMhjuIFQAjyOAEUF1eR1Ol29f_Ri6ziC2jJxa3lWv1fQlW6-eLmyg0a_1MIT1nya6kVtJNQP6pwed5E32tP4Jvtob6Amql4VbS8mcN43mwQruBPnyNbIdnxADV-IhSm3-CQMpYgdCDpvu35Nz7RGJNCLWo3KQO-nmg5WoImvkHIkhVKbd44VD_WG4Bqet5hIsT0Wi3A-2NlS3JPMquAtQVvIIZQATFY-wEXkjoTnsz9jBjJHwEbicGdo7HZfBb5XA9Euya_rvnOAeJK9WaBtqDHMsm0_2pgYkjvSmfr18AY5YR9o3ITJGeIeMy-yI1LeYuRXOSOjgvgoEHUCZ3fxDnXmtX85Taj2mTr21gjNS0jD1bypwPyZsZZnd6I-ZPpdAsoGoSA3hgJv2c2xyE","dp":"dtWooDenOIo6qq6A8nWkMk42pr5MjWhXj71I1R8FIkg7KrzyX3h7G5unrgW0rW90A3aMbq2vAkuhSADDv024Bsdo4N9PaeUr_gEifgnr5BPz15tdwyAiZOf5tch3ZIGupPvMKJ6B8hzxYLOLQiFj08XZzZ2ApfubriIgRqWkvvo1si3OSu_8ExdiANawoLdop3qX4RYXSBROPhZ1g5YDqzoZGTSA3h9hNiGgiXS__azIFrW-BkilLrI2H_rDTM3xBQcg49Wa1xnsUUZe-VGmgL6kAAjh4QA661fjb2yFs1qZ18zidXuGXBp4uTx0XXBAwnRNur6odyeq24aKWnldvw","dq":"yyC-RUyH_8HmvWcT87HsyLuReqQqpTFs0KVOjiTm-4Ng_vXWL2VLPXcaS44U4YGxvmTIJ26UOjm8xmDXjyyI2czTx3sZX3ol_2l-AIrjjUAwRpIU3pEcbAFBq1XOlV7801_mn5pW7lQ9xmYCrmAArCZ7TzEiKf9vG6ZT4DsLgSfA2h5St7EqC5cog5wEuO-_8PzveOy7dxTj-EJFMXR-epViPUIpWpofgB3rXAP-YZ28m6MNMcDuSaM1BKzwm1fQeLnIROh942anSs9Qfe6hf5miA1mZ4bx4ckYBQ3WN6W3kUGDunZ41agyW6gBrJO9GAIUgt7TxpVYWb1JU3dS1IQ","e":"AQAB","key_ops":["sign"],"kty":"RSA","n":"u_fUJ_3ByHEVEPZ-l-ZvEqLuOp49hRH93FRy4g9TRVwcnaewUptA1mgxzIVwX1HB5geZw6afmiHYY_zBoQDYj3fpyhnwY-H-pvfoj8DOrBBMTjYkUNiCjQBvVxCdWvolNTjd1QJ7VfEpcS_gLWSrXaeLhWh2OYAn2YcbYJ7sFJ34pbDnPkZzxZlQhK0-rgTkLJzJ-KYJN8ZspnFNBmWSdAVgZ6Zbjd8ytrr-J2TQLGmkSXjidY2h-ets4BBzZ7fek6wThuTXrUnAaXiAw9EZ6Ny_bbU6gyJbQj884rjM_gYI-_FqbjXB-nqMHxH4nGiOhCk773VM9LYOzXPYGReA_2jUcNH-tKa3VKjjSL4V5pEKHTzxZWjmoeRoOYRAvYwuXWUOrGEBme4d20zsf-n16IMW2wMq7A5ABinVwOsFjd6h7jJM_MfcDHr4K3k8R21-N55Yf6xqnuABrFkTb1Vcg24lq7DBYLygS5SvM1NcJazZG5n8HKyMpatAK2n7fcF_U8-XhaTwYxKmC1EvlbZ5fwYwHG5PDcXbsvEdmlYwF4j1Io4sY1BmvUGqRhQAJCv3HLLDzXPlzKvzYdf0EB81NwfMOhuL3Uu2NO3p7hiVIuPcgziStofup04Wa9wVrmjuA_PmIQEaIxMFgEiQbT6lLvm48r8IwjbyxdfDC279ecs","p":"5XV4akLG7WdRmBaYMyhdZ-qGs4DrLEYP4pczhp_-Uf9NS5luLSvCJvSJnjbibzkCdU4hyNmhAnTFEVNR8yS_4ozBbAhb95397VktwQ2sjL3rZ9jCWAFPC7OCNFDswFeESv2ps6zHwqA2xV0v8fnQmLuzD_4OV4pKCQT1YOH_t9NSxEwfWiw06UU18Cag7_jzV8QyvlehrL4mG5DKVeAW8EWqPIxWGEYMumGqU0tDLytI3UAb98DpFqVDKtsLOj642-FNKNTPJw2j1vV65xeCNYuYPEGS54aBOuAUFoljOHzxaIWcHCImuGufZLlQ8-3ar18DpqOubxoeqWZnUydpRw","q":"0bXFPiXt6xHNeYXL6Ghm9Yxp6MtF0ht-1K42V-VfRZERl6CW4PpVHl48mVfqgwLBYSrnHFIvuAwYIe4eU5NPGZtVF7VIyzN67M1ORrCekaV2ZaKdcRpWg_FX9w-v5-wzLWEufNu7QIl8SMxzEH8saND1qq9A3Ai_W-_NcH5ixXUWXX4JDsJrKWWsrZaqXTDptbhQvlTNdetllPq7IqgFWg8mf9ceR_Vk7MsrLK4xYjj3vxZUKLUOJCO9s2rn3ns5dgYiQdFcOIqkJ9aOdV24HOMhxCsXToT2BqPG3qLdYO5Ha9-a0fL6c7M4UvF4dMQyppT9018-Rm1aADqa299tXQ","qi":"1ocEUtKpZX0n6xjGykUa5PP0_hbousWDWFzI3mQkp3KwlfrToUYRiLBZk9GiEIPn0fgwbdzuuxYmCeqRkV5KhCu0yY1RD0sz2_zemDe5jBi_GRDKM-wa39MU2sfzEqOd9w0or094RUzFT8gHTOpnsdvFEPHe0PovkgNomAu7u6--4Ex-Scv-CjRDwb8mzuKaEdS0nWx8e8u7c5a4iVPG6GoqmMXsuVDgQT7QF00e4-GqadmSt35k_cpQftlbqoAduv7vIEKjvsEkOQgTkqlX9zqzyWOUE9YJAdL9xuyydvEufyRDFjxdLSqBvJwtAJ5FV6fxywoaeszTBBHh5KrCRw","kid":"d2WYV9apG5bG9tdHz1HG1wTjxhQbEgrXFoc8GAsbjyk"}""";
            //var nyNøkkel = """{"alg":"PS256","d":"IRXwTqqeR-jFnhKndqFoOPnrnMr_bJEozGmrIEMrzjlwF6yCVC1i3HLt3gF-ZYRVSWuEquHtZIQ1m-0qd0YJXq_k-tuL5INVp4A2tbqbcrvGIa-qOjkpuVtCPzOVxsUjNvu5kpiq4R_HJzbmishrjaT5peujv6qwJZl1QSp0gLGgmRCC_ninvH23J40lvywSnM2MbF9w_cpFYdvf46SbCEBklMC_sdRnMBr7NEBFz2BVILO_omUZYXwFGT8eZ-d37UMS2_Nr3cDsEoEgf3Nexb1e3fy43CTKb-EMAGt6s6a4hm2_28Bjhy0HygXjYeMh8JT_9r028SljkTSLam1Zd6r9Y8CkcuXWNxzLvZtF5B0BWG45cp6FIbGp9yTq93rhe2AFMvVcQI076sDf7CjDAej90Db_lBqjM0AmvHoeq2E1coBeLYdSiEPRnQ_cnzkzvaCu9rhGhxyRyhjzVeka6EP5r627FwSiNIBa6D5-ikWaHqDarA0I5btX3iPryXTNJ11kG6B6KedrQp_RX8PK6uxUtQVhRq1FJGzC1Ib1Io2OXcC-c3ACN8JmocRp4TpUzQKAxXeyS4WYKCQWjZxAjc5ZRMWNMTQRNbekLmUXHIqLLiVO3zizUb_moKCFxADpiKsJ6rZpcdS8_TK-XIAYiIEsDAFD-36qcuBxhfofVQ","dp":"MXLrXZOqsW204sI54bO8jOZp1wKuEzGFJdFZVay7VUWI18oniOa1K_FqAeT_elWj4AFf9rqqcrOOTjTUW5EeLzi6YaHIxVSQpTema-3ygXI7GkrfAND6jHC5BaisDj4F00cw36mb9VTYi5unZnMQh0hIy7cH2iKtV9Ti1adQiB1BhM8YZsqwSxdmIn0UMxrEscs3tZjftA9UYRLWGcfTxmwLCfw6pJGz2s6Tk8wPW3CbJkhYLJUq369bTUE1zMaLYBaqt-UzC0ien2vsw4g_pIdFIkcjDZjr7_CrSZk3LKnwwdu70ay6QEcfTMyRdGVRJIRlaHknC_nFYaaijV3xrQ","dq":"ULHZgyJCLP9_KvT3gzi5tOnmaeKeVtrxV7dyrEBGt75XF7mdQDBGR8LDBI5l_jiMuNmKH0-1VKXcArkwegCPnZXCNPjiWIMHvu11SGzLwyVcztJc4D7LxS_B-__IM_m9WpOI2PtdTa0UOrDbZPhYu8FK0CDmWniTn8qiDZy9OVbafJDhnBKwkP-Vrx5nb9Z9f0LWhiDz-V8Fmn_Ua3yISWw0T_KMU1-i0cE5Ub8HzWr4x5f6z9sDKS-gB-n6A96YZnf2wKzb_tI3DMex_xV6_EOrqBWePQTclR5Cjck439OJc5fqky1YzWO89n-cRA4qSSBPYzn3OelGmb_XMOeMkQ","e":"AQAB","key_ops":["sign"],"kty":"RSA","n":"p7lfxjx0U8iBZyJT09G4SOnpo0yZLfO_87FCGP74vZG1kQqnTPwFQ5mNAjSF13_lqJIFg0yFMmhwKT45wFOoA6spZqn0mGF3-hitbLMIgHW4WILFQ95-dzo1wG6sPqHIKSrIhW41GtMsfrGyufWrhqn3WC8VIoDyYcY8F3CWZiQk9tV3bOdo-SM9kdPoKiy1Z0pSQYCU2ydZljP-uR5jvV_v8YgCRNVoApPeFXR5-Sa-Hpdzw-VNb_LSzB-EkyBQQIjfqfI21cw78vRWMI1FkQhUL2_6J9_QQDo3KGLBQAc2Hyx7Hmu1YKUMfwDmLHxGF-ZY8gDnkmH-oCkfB3XwQ5zbkopJmKPWPHrVkaZ-OGDtoJED0kPQFgWfOToGmt0VMna72Sfr7tWjdtrtHNkghZrOpo1kSaxg5OWo7i3yK0uz849BG2uRoTM4_gSI1JwDtN429K3E3WmuVdFcPJ19fnzQ73RCreFrpKSL5LAcfGrKCxKdnWTClbwfmPDgct08Y4F8eVIijO-WmoNqNrYTsCBEc8WebVcGlle8ZWuLFQ2OL9DRmk9Fmjj0mTjwaJv-CfeVYTRMejTNsgp4PI4u_CQSOm4Zfm4ZvTaVxdj5C0WxWp-uUSaVczLLkV0NznWks3Ihn646jd8CPcItf24mfAwfxx_ER9eHekFR8TjnWj8","p":"33fOTHRfId1xBWLU0fR1pioh6xu75LytsPW2DZgCAzFb7GxOJk-LZcK-fwL0X2pF7xNPwcR-6XmlJ6H90Ww-AJ3F7ckJVx9HvKRyT8wAsgXw5gPD55F7jxSJzdNVYoDv0VgW_7ngaw92LOl-Lv_yV8ikc_Crdsbm3xluhAKCjLBGFR-eqSrzW1Rv4Y2EOOTqypTNxlI2z4It1WhiOxCV8l5uwPeAocaZzLVxDgKG7b8VaSqEDxBWOyQHbMkDP3M0VXmtSgi8rlUermInCcwoMPwcRY57KJDHj89V3h2ZgY4zQo86hqory-nSGfuFS5E9E1bZo2dUparwESij41c5Ew","q":"wCQbud5XuElUlleZ1wDmyn9ErSgSGETUPFohS3CRw9nkc3zKevkaYL1kx20RfdjjjVJJE4yP8fdzAK5K9VUGpGqy5td6hoE_rJAXt2W3mcYvSbF1sz7M4bYuBNpZ_nSb_7Xr86_-5MBvrxd1NZI6Jo_kL0iSGAYVbtBu8b1bZGB31A5rC2Md-8KZ8ApUSaT5d-lI90CRfSUCIoBX6AyvNhlaG_d7m_VXxuR147pxcFgoDiUAx52pNIVGkk3sQwwOe3InJPogxg6QaopQDSpR8G-vc4eqwNHFPHuWmg8qrsAh_wugtl9thDpIfnYcYiqex5X5QwRNH14X6bzRig1LpQ","qi":"U45fcksXKLlSuGDFe3foSoFuEtOmbtpvDDxItAw5GlTuibpLqLRoowEJZ04kGrjfOgI841dykWKURbXSibv0rtnUSjtdK3ARx4t_wj9Zro4FBQqGlyPpymxQxX37yvx5FvXWsyfroe_7yPfYiRglcLaFX5yseXNUsDF7HrwTLBSCKDpD7CbQz0UtnbvzqIMonoA9LFOffBh9sjuASafIAe8ZUKaXHB1sIuzehYXRlMjOW6LB_9Cd-a-3weWHEJOHWvEw1W1FsCsdTyovhNRsedHAB6bVibvEIkpB8HTP8vtkNGLMeHFqD1OYe281irL82Uk99omIbuQCI2Ax8H8apA","kid":"gBfEo0QhGsSVMd7pyxbT3935hwMyQeK31fu4T0WmFGk"}""";

            //var helseDataPrivate = """
            //    {
            //      "alg": "RS512",
            //      "d": "j58ARP6c83R-uEkIWjWpMq0zy5Ik4ySpNJsGJSq-oW2Mo9K5i9nh-KOA-i4BnnWC-pfzI8ju6AB58dFNI7VPHxKg2vryqcl95P7kH6qHQua5UPsUrN-Cs-0_O6geS-OFixnNsb8QQC9_23dSi2ADJIfrzWOPHH_pGQ9g-iJFLD0pYF9OU7y9gUzqg2Zv_x66f18vH6wqBCHB9FsjZkcgNS9LmggjEyq1fsnrJxdQKaypocIqc0pumKmDXYW5PbCB9YFHyj9LzIaX-1dBDH7lHP4PT8VokrNzMPUNjLdlEo0lfrIQMqxcI5s08negIWJMrczBzP6hagxDQ0KsuuS6tV0Q14NPDT8S8OcLneSXby1hbs_rRUUulemYwPeHarefo8VQq7pgs1do8Sp7jWShbZq67voSDj8kX5M0LIInaEliaLcTyG7tv4RfJ_vd--ho452_6ty9gqXKbOha8A_ZuY2NuvFhnRVKGmaoMVSccuU_V5TOa_NhOoJ_fMiUhLHAHIWMdQpybDiVJoQJDag_BKCveQt2U9t5jL4ancFCzj05cwjA1ckMSId5W2or-S8L0Xs7MmLZLDwHGtEosrmVaUc0IoHlw0CF5Nuyih0hPDYs2f5DTtf-pJWdYysTRnudcbF4g0RjZeUvsI6-7Srsvxiz1wA2DgCdEyMH9q4R0GE",
            //      "dp": "jObiD9ETBSVfHnWs-PSJ6Si4a_Ct38oSTwqHO0SWO-bHqSzGkA9HJ_JPXKz4l-w0hr3j3dVS5v0k82zGrW6YoHROxqhTF9nj-P7V86uHKBFYAOLdrT6WIHzOdCNUWYJ6xLL0THXKzAPWw6_c2-To6E13NXYeYDDuZN2I8s6R9IAkWYFlsRDAM181W5or6r7heNJyrtMgl2WjxGR2eEh7VF2d5cJcFCA3LBxpvnFms-g7GORlBwvo3dN8cOIqviChhPc4Q_AmY89I8HH-PJZHsKuQeykzYKbd5Ck-B0ecdj1m4q79B8ywGevEzyz3tZ96n9v34EPFnufZ2xTGoRrU-Q",
            //      "dq": "jHVK-MvK5Lt1rf7Ndh9xIrRYpw72Lt32mdCF9w1BCLZwdYwQHzbvoPSu_F___X7k6zKqc-uGgtlo6LTkvBEK6YhJlzAItaaKqaFcKYHiGW-cB4vNaVw-j2VFWZmI6QOKVpDSWW4CbNeuRW6OS_kXvPPfFAwIjjkzRh56Z8lNurVL3CNJXehQZTpirV2kZwZjXOv8jFK-2L2o3wQpygtc7-j2i8h4Re47FU9vUWGcMzSG51gzlYBvfLwaqBD7Ltl9KnUcLcEDxjgLnicINmnXskfubRHzFsJHCyCYctXy_v2KGBf_1sbmEwD5W0Oi_kOxrPLHmkVcs-t1c55CsDTu-Q",
            //      "e": "AQAB",
            //      "key_ops": [],
            //      "kid": "yY4Ndyf1JqzfKc1O5bzZTWjS1JiAil-TBd-bF_7l2K8",
            //      "kty": "RSA",
            //      "n": "2BTHvux__RfxmCQcmsOCzKZJBRDJijwolPhmTp2GTRVJZkFWE8RHAiXbaIJ9mt1Dj-KODl0bUlIZxy1dKth5-_eJaZ6R3sjNQuJjAaM7XZijMH-6RoxKxmfUO9jY9B2g1RInF0DwtyvdpiX6F4XYQGHjchpm9uuUw1pILYe64NelhwhofI_4FwE-rHV3B3fOJvxe9v4JB1tLBpyzm6LyfB5IXWUdEzdjZll7bAJktpcImDY71f8qMPGjC2JZcZmZEjbN5u9wY8f7374oLGHlXXBMb0REyNPK_gbbAlUz6qr-_P0IEUgRZUSNULSmNMQLMLdz21SSXRPHG7oifsM95FyT0-lPa6GoobDajNZcm5q_llEd_ujKwpjNupG44TzulbVruoZnN06awlsLK-g2YaOz7-A0mD_foS4iM-nqBuKvwtz9kK_pZTiQG0zz1Qoudx8tbO73ag0XQJAPTQ47QnbeDOsJLXb8D9k6xhx6es280ts4TUpfn3ckka-alDS0_WlTOaQZHpRp7T8Y6G8ouxHkkxJhwqcVylYl_Wy7auMXroXlvvc3Mx1muG3PgmNjXQAaz5jq49AjdmZKcevQeu2CqjnJFs89TlfnppRGX0C1aK5w9Ka8OQJY36Lymj7bXTqU2n0VdB-lqjl5u_puwAeygxdDyBxFDqiOjx1uoZ0",
            //      "oth": [],
            //      "p": "26z5fOnGyq2dqEjClHWgvPPnFWtRMenYWTxtRA-ZfuwSH6V585ynpCvkhAJe408G3PXoDWfBB_dNlx21LebyLptEM6_EweNHRVJOZ-3YN7CvHSC08oGRQOOEQa-EbSy6DqahBDoeXRiMKjtkp4K4lWouvY3GThgbnGQnwfnwYSkmOyHtvrSdAFyfFqCtFXpvX1hHI6AdfbYo1wDeuosFRFX0xCYcP5se4_u_j4Y7IT64m4L4sEZy5IYj7vCBNSZdbjvcNb2oR3VSmnXxhX8QVtbQasGOZVoAaH_a4OC4WAx0cREGpJZNERmYPnhU-9RZJ2G05jmTB4MJl2O3WGletw",
            //      "q": "-8-lyd9dMvEkgnRUS0YqFrpbrbLWDRUhlak3xL_hrU4wbq2oLYpl9laOXQxT5-brFv6qwAjsvpeDpHEmWtrSN_1x3UbXVrD7GWD9TY0QlAbC2CNUYTZtKNcNTDZcSe0kvP1mvC-XT9IGwjYzcok6Vb3O7Dep6FB13nRAsfUAgRmCPKrpH2m7k_MrgCgDZOPdZov1E9r9ll74qmczgE1ci8Om1_bXLPLQQ8ANrOxnHgF4rIvpWbGoak1O8EE7-NyX2ggrfpDU8MKjk46KaqCbRTbvpeqn9rzXHNJWd-91NUEUPGh7zbzq66D1W3ABzlqW_PpYcM9yxf0YrATACc0uSw",
            //      "qi": "vA0i-42dOuA0M_rn5yZVtnDMPE5x_XwpVQaXse0MINPNLu-uNJNnBXyHPfPFL7AceFUZ9eVkp_MBrTnHqpJ6GR4nqN3wTb2UaS4qFektxgBy-_OhKzur89ApFoMwDLjPPz5ugEZcuEOHqM1c5J93dxmFIrqMYVyOk7ZV7QDZ1bCvdK8GZJEcji2kB22fcSEO-BbMZmp10zGECWUEPyqj4XWO53oRtu3Cq7kN8k1IrSeWjDIws3t-lQPSs7_Ph4IsKOHrn8FfpvdrKgN0lpTXzrZAVhK_U4kvrnZoVMTpEF79GXhP-FEDkhduR4mOWVhaqqgUgGPdJ015N97KyalbPw",
            //      "x5c": []
            //    }
            //    """;


            var assertion = ClientAssertionTokenHandler.CreateJwtToken("http://issuer", "clientId", errorKey);

            var handler = new JwtSecurityTokenHandler();
            var token = handler.ReadJwtToken(assertion);

            //Assert.Multiple(() =>
            //{
            //    Assert.That(token.Issuer, Is.EqualTo("clientId"), "Issuer mismatch");
            //    Assert.That(token.Claims.Count, Is.EqualTo(7), "Unexpected claim count");

            //    var audClaim = token.Claims.SingleOrDefault(x => x.Type == "aud");
            //    Assert.That(audClaim, Is.Not.Null, "Missing 'aud' claim");
            //    Assert.That(audClaim!.Value, Is.EqualTo("http://issuer"), "Invalid 'aud' claim value");

            //    var subClaim = token.Claims.SingleOrDefault(x => x.Type == "sub");
            //    Assert.That(subClaim, Is.Not.Null, "Missing 'sub' claim");
            //    Assert.That(subClaim!.Value, Is.EqualTo("clientId"), "Invalid 'sub' claim value");

            //    Assert.That(token.Claims.Any(x => x.Type == "jti"), Is.True, "Missing 'jit' claim");
            //    Assert.That(token.Claims.Any(x => x.Type == "nbf"), Is.True, "Missing 'nbf' claim");
            //    Assert.That(token.Claims.Any(x => x.Type == "iat"), Is.True, "Missing 'iat' claim");
            //    Assert.That(token.Claims.Any(x => x.Type == "exp"), Is.True, "Missing 'exp' claim");

            //    var typ = token.Header.SingleOrDefault(x => x.Key == "typ");
            //    Assert.That(typ.Value, Is.EqualTo("client-authentication+jwt"));

            //    var alg = token.Header.SingleOrDefault(x => x.Key == "alg");
            //    Assert.That(alg.Value, Is.EqualTo(SecurityAlgorithms.RsaSha512));

            //    var jwk = new JsonWebKey(keys.PrivateKey);
            //    var kid = token.Header.SingleOrDefault(x => x.Key == "kid");
            //    Assert.That(kid.Value, Is.EqualTo(jwk.Kid));
            //});
        }
    }
}